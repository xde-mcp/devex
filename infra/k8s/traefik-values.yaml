# Deployment configuration - Use Deployment instead of DaemonSet
deployment:
  kind: Deployment
  replicas: 1

hostNetwork: true

# Service configuration
service:
  type: ClusterIP

# Port configuration
ports:
  web:
    port: 80
    expose:
      default: true
    hostPort: 80
    exposedPort: 80
  websecure:
    port: 443
    expose:
      default: true
    hostPort: 443
    exposedPort: 443
    http3:
      enabled: false
  metrics:
    port: 9100

# Additional arguments for Traefik
additionalArguments:
  - "--log.level=INFO"
  - "--accesslog=true"
  - "--api.dashboard=true"
  - "--api.insecure=false"
  - "--ping=true"
  - "--providers.kubernetesingress.ingressclass=traefik"
  - "--providers.kubernetescrd"
  - "--providers.kubernetescrd.allowCrossNamespace=true"

# Providers
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: true
  kubernetesIngress:
    enabled: true
    publishedService:
      enabled: false

# Dashboard
ingressRoute:
  dashboard:
    enabled: false

# Resource limits
resources:
  requests:
    cpu: "100m"
    memory: "128Mi"
  limits:
    cpu: "500m"
    memory: "512Mi"

# Security context
securityContext:
  capabilities:
    drop: [ALL]
    add: [NET_BIND_SERVICE]
  readOnlyRootFilesystem: true
  runAsGroup: 0
  runAsNonRoot: false
  runAsUser: 0

podSecurityContext:
  fsGroup: 65532

# Logs
logs:
  general:
    level: INFO
  access:
    enabled: true

# Traefik native ACME is disabled (cert-manager manages certificates),
# so persistence for acme.json is not required.
persistence:
  enabled: false

# Node selector to pin Traefik to a specific node (important with hostNetwork)
# By default this is empty so install cannot fail on fresh clusters.
# For pinned-node deployment use: infra/k8s/traefik-values-ingress-node.yaml
nodeSelector: {}

# Affinity rules (optional but recommended)
affinity: {}
  # Example to prefer scheduling on nodes with a specific label:
  # nodeAffinity:
  #   preferredDuringSchedulingIgnoredDuringExecution:
  #   - weight: 100
  #     preference:
  #       matchExpressions:
  #       - key: node-role.kubernetes.io/ingress
  #         operator: In
  #         values:
  #         - "true"
